<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="author" content="SemiColonWeb" />

	<!-- Stylesheets
	============================================= -->
	<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700;900&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="css/bootstrap.css" type="text/css" />
	<link rel="stylesheet" href="style.css" type="text/css" />

	<link rel="stylesheet" href="css/dark.css" type="text/css" />
	<link rel="stylesheet" href="css/font-icons.css" type="text/css" />
	<link rel="stylesheet" href="css/animate.css" type="text/css" />
	<link rel="stylesheet" href="css/magnific-popup.css" type="text/css" />

	<link rel="stylesheet" href="css/custom.css" type="text/css" />

	<!-- Freelancer Demo Specific Stylesheet -->
	<link rel="stylesheet" href="demos/freelancer/css/fonts.css" type="text/css" />
	<link rel="stylesheet" href="demos/freelancer/freelancer.css" type="text/css" />

	<meta name="viewport" content="width=device-width, initial-scale=1" />
	
	
    <link rel="stylesheet" href="demos/freelancer/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
	<!-- <link rel="stylesheet" href="demos/freelancer/css/recbole.css" type="text/css" /> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <!-- Document Title
	============================================= -->
	<title>Quick Start | CogKGE</title>

</head>

<body class="stretched">

	<!-- Document Wrapper
	============================================= -->
	<div id="wrapper" class="clearfix">

		<!-- Header
		============================================= -->
		<header id="header" class="border-bottom-0 no-sticky transparent-header">
			<div id="header-wrap">
				<div class="container">
					<div class="header-row">

						<!-- Logo
						============================================= -->
						<div id="logo">
							<a href="home.html" class="standard-logo"><img src="demos/freelancer/images/KGE1-01.png" alt="CogKGE Logo"></a>
							<a href="home.html" class="retina-logo"><img src="demos/freelancer/images/KGE1-01.png" alt="CogKGE Logo"></a>
						</div><!-- #logo end -->

						

						<div id="primary-menu-trigger">
							<svg class="svg-trigger" viewBox="0 0 100 100"><path d="m 30,33 h 40 c 3.722839,0 7.5,3.126468 7.5,8.578427 0,5.451959 -2.727029,8.421573 -7.5,8.421573 h -20"></path><path d="m 30,50 h 40"></path><path d="m 70,67 h -40 c 0,0 -7.5,-0.802118 -7.5,-8.365747 0,-7.563629 7.5,-8.634253 7.5,-8.634253 h 20"></path></svg>
						</div>

						<!-- Primary Navigation
						============================================= -->
						<nav class="primary-menu">

							<ul class="menu-container">
								<li class="menu-item"><a class="menu-link" href="home.html"><div>Home</div></a></li>
								<li class="menu-item"><a class="menu-link" href="model.html"><div>Model</div></a></li>
								<li class="menu-item"><a class="menu-link" href="dataset.html"><div>Dataset</div></a></li>
								<li class="menu-item"><a class="menu-link" href="evaluation.html"><div>Evaluation</div></a></li>
								<li class="menu-item"><a class="menu-link" href="http://159.226.21.226/financial_graph/"><div>about</div></a></li>
								<li class="menu-item"><a class="menu-link" href="https://github.com/jinzhuoran/CogKGE"><div>GitHub</div></a></li>
								<li class="menu-item"><a class="menu-link" href="#" data-scrollto="#footer" data-easing="easeInOutExpo" data-speed="1250" data-offset="70"><div>Contact</div></a></li>
								
								<li class="menu-item sub-menu  current">
									<a class='menu-link' href="#">
										<div>
											Get Started
											<i class="icon-angle-down"></i>
										</div>
									</a>
									<ul class='sub-menu-container' style>
										<li class="menu-item" style="">
											<a class="dropdown-item" href="install.html"><div>Install</div></a>
										</li>
										<li class="menu-item" style="">
											<a class="dropdown-item" href="quick_start.html"><div>Quick Start</div></a>
										</li>
									</ul>
											
									
								</li>
								
							</ul>

						</nav><!-- #primary-menu end -->

					</div>
				</div>
			</div>
		</header><!-- #header end -->

		<!-- Content
		============================================= -->
		

			<section class="probootstrap-section">
				<div class="container mycontent">
					<br>
					<br>
					<h1><span class="gradient-text gradient-horizon">Quick Start</span></h1>
					<div class="line2"></div>
					<br>
					<h3>Pre-trained Embedder for Knowledge Discovery </h3>
					<pre class="my_code" >from cogkge import *</pre>
					
					loader lut
<pre class="my_code" >
device = init_cogktr(device_id="0", seed=1)
loader = EVENTKG2MLoader(dataset_path="../dataset", download=True)
train_data, valid_data, test_data = loader.load_all_data()
node_lut, relation_lut, time_lut = loader.load_all_lut()
processor = EVENTKG2MProcessor(node_lut, relation_lut, time_lut,
				reprocess=True,
				type=False, time=False, description=False, path=False,
				time_unit="year",
				pretrain_model_name="roberta-base", token_len=10,
				path_len=10)
node_lut, relation_lut, time_lut = processor.process_lut()</pre>
						
					loader model
<pre class="my_code" >
model = BoxE(entity_dict_len=len(node_lut),
		relation_dict_len=len(relation_lut),
		embedding_dim=50)</pre>
						
					load predictor
<pre class="my_code" >predictor = Kr_Predictior(model_name="BoxE",
			data_name="EVENTKG2M",
			model=model,
			device=device,
			node_lut=node_lut,
			relation_lut=relation_lut,
			pretrained_model_path="data/BoxE_Model.pkl",
			processed_data_path="data",
			reprocess=False,
			fuzzy_query_top_k=10,
			predict_top_k=10)</pre>

			<pre class="my_code" >
#fuzzy query node
result_node = predictor.fuzzy_query_node_keyword('champion')
print(result_node)
						
# fuzzy query relation
result_relation = predictor.fuzzy_query_relation_keyword("instance")
print(result_relation)
						
# query similary nodes
similar_node_list = predictor.predict_similar_node(node_id=0)
print(similar_node_list)
						
# given head and relation, query tail
tail_list = predictor.predcit_tail(head_id=0, relation_id=0)
print(tail_list)
						
# given tail and relation, query head
head_list = predictor.predict_head(tail_id=0, relation_id=0)
print(head_list)
						
# given head and tail, query relation
relation_list = predictor.predict_relation(head_id=0, tail_id=0)
print(relation_list)
						
# dimensionality reduction and visualization of nodes
visual_list = predictor.show_img(node_id=100, visual_num=1000)
					</pre>

					<br>
					<h3>Programming Framework for Training Models </h3>
					<pre class="my_code" >import torch
from torch.utils.data import RandomSampler
from cogkge import *</pre>
					
					<pre class="my_code">device = init_cogktr(device_id="0", seed=1)

loader = EVENTKG2MLoader(dataset_path="../dataset", download=True)
train_data, valid_data, test_data = loader.load_all_data()
node_lut, relation_lut, time_lut = loader.load_all_lut()

processor = EVENTKG2MProcessor(node_lut, relation_lut, time_lut,
				reprocess=True,
				type=True, time=False, description=False, path=False,
				time_unit="year",
				pretrain_model_name="roberta-base", token_len=10,
				path_len=10)
train_dataset = processor.process(train_data)
valid_dataset = processor.process(valid_data)
test_dataset = processor.process(test_data)
node_lut, relation_lut, time_lut = processor.process_lut()
						
train_sampler = RandomSampler(train_dataset)
valid_sampler = RandomSampler(valid_dataset)
test_sampler = RandomSampler(test_dataset)
						
model = TransE(entity_dict_len=len(node_lut),
		relation_dict_len=len(relation_lut),
		embedding_dim=50)
						
loss = MarginLoss(margin=1.0, C=0)
						
optimizer = torch.optim.Adam(model.parameters(), lr=0.001, weight_decay=0)
						
metric = Link_Prediction(link_prediction_raw=True,
			 link_prediction_filt=False,
			 batch_size=5000000,
			 reverse=False)
						
lr_scheduler = torch.optim.lr_scheduler.ReduceLROnPlateau(
	        optimizer, mode='min', patience=3, threshold_mode='abs', threshold=5,
			factor=0.5, min_lr=1e-9, verbose=True)
						
negative_sampler = UnifNegativeSampler(triples=train_dataset,
					entity_dict_len=len(node_lut),
					relation_dict_len=len(relation_lut))
						
trainer = Kr_Trainer(
	train_dataset=train_dataset,
	valid_dataset=valid_dataset,
	train_sampler=train_sampler,
	valid_sampler=valid_sampler,
	model=model,
	loss=loss,
	optimizer=optimizer,
	negative_sampler=negative_sampler,
	device=device,
	output_path="../dataset",
	lookuptable_E=node_lut,
	lookuptable_R=relation_lut,
	metric=metric,
	lr_scheduler=lr_scheduler,
	log=True,
	trainer_batch_size=100000,
	epoch=3000,
	visualization=1,
	apex=True,
	dataloaderX=True,
	num_workers=4,
	pin_memory=True,
	metric_step=200,
	save_step=200,
	metric_final_model=True,
	save_final_model=True,
	load_checkpoint=None)
trainer.train()
						
evaluator = Kr_Evaluator(
	test_dataset=test_dataset,
	test_sampler=test_sampler,
	model=model,
	device=device,
	metric=metric,
	output_path="../dataset",
	train_dataset=train_dataset,
	valid_dataset=valid_dataset,
	lookuptable_E=node_lut,
	lookuptable_R=relation_lut,
	log=True,
	evaluator_batch_size=50000,
	dataloaderX=True,
	num_workers=4,
	pin_memory=True,
	trained_model_path=None)
evaluator.evaluate()
					</pre>
				</div>	
			</section>
			<br>
			<br>

		<!-- Footer
		============================================= -->
		<footer id="footer" class="border-0" style="background-color: #C9D6CF;">

			<div class="container">
				<div class="footer-widgets-wrap  m-0">

					<div class="row justify-content-between">

						<div class="col-md-4">
							<div class="widget">

								<h3 class="h1 mb-5">Let's Talk!</h3>
								<span class="text-black-50">If you have any questions, please contact us in time and look forward to your feedback.</span>
								<a href="mailto:noreply@canvas.com" class="h4 text-dark mt-5 mb-4 d-block"><u>zhuoran.jin@nlpr.ia.ac.cn</u> <i class="icon-line-arrow-right position-relative ms-2" style="top: 3px"></i></a>
								<div>
									<a href="https://github.com/jinzhuoran/CogKGE" class="social-icon si-small si-colored si-facebook" target="_blank">
										<i class="icon-github"></i>
										<i class="icon-github"></i>
									</a>
									
									<a href="https://youtu.be/csgnjU_F3Qs" class="social-icon si-small si-colored si-youtube" target="_blank">
										<i class="icon-youtube"></i>
										<i class="icon-youtube"></i>
									</a>
									
								</div>

							</div>
						</div>

						

					</div>

				</div>
			</div>

		</footer><!-- #footer end -->

	</div><!-- #wrapper end -->

	<!-- Go To Top
	============================================= -->
	<div id="gotoTop" class="icon-double-angle-up bg-white text-dark rounded-circle shadow"></div>

	<!-- External JavaScripts
	============================================= -->
	<script src="js/jquery.js"></script>
	<script src="js/plugins.min.js"></script>

	<!-- Footer Scripts
	============================================= -->
	<script src="js/functions.js"></script>
	
</body>
</html>
